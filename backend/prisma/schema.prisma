generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  firstName String?
  lastName  String?
  createdAt DateTime @default(now())
  funds     Fund[]
}

model Fund {
  id             Int        @id @default(autoincrement())
  name           String     @unique
  ownerId        Int
  initialCapital Decimal    @db.Decimal(10, 2)
  isPublic       Boolean    @default(false)
  createdAt      DateTime   @default(now())
  owner          User       @relation(fields: [ownerId], references: [id])
  positions      Position[]
}

model Position {
  id         Int       @id @default(autoincrement())
  fundId     Int
  ticker     String
  entryDate  DateTime
  exitDate   DateTime?
  quantity   Int
  entryPrice Decimal   @db.Decimal(10, 4)
  exitPrice  Decimal?  @db.Decimal(10, 4)
  isActive   Boolean   @default(true)
  fund       Fund      @relation(fields: [fundId], references: [id])

  @@unique([fundId, ticker, entryDate])
}

model StockData {
  id     Int      @id @default(autoincrement())
  ticker String
  date   DateTime @db.Date
  open   Decimal  @db.Decimal(10, 4)
  high   Decimal  @db.Decimal(10, 4)
  low    Decimal  @db.Decimal(10, 4)
  close  Decimal  @db.Decimal(10, 4)
  volume BigInt

  @@unique([ticker, date])
}
